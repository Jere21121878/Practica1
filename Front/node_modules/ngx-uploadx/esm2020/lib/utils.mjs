function safeMatch(base, re) {
    return (base.match(re) || [''])[0];
}
export function resolveUrl(url, base) {
    if (url.indexOf('https://') * url.indexOf('http://') === 0)
        return url;
    if (url.indexOf('//') === 0)
        return safeMatch(base, /^(https?:)/) + url;
    if (url.indexOf('/') === 0)
        return safeMatch(base, /^(?:https?:)?(?:\/\/)?([^\/?]+)/) + url;
    return safeMatch(base, /^(?:https?:)?(?:\/\/)?([^\/?]+)?(.*\/)/) + url;
}
export function unfunc(value, ref) {
    return value instanceof Function ? value(ref) : value;
}
export const pick = (obj, props) => {
    const result = {};
    props.forEach(key => (result[key] = obj[key]));
    return result;
};
export function isNumber(x) {
    return x === Number(x);
}
/**
 * 32-bit FNV-1a hash function
 */
export function createHash(str) {
    let hash = 2166136261;
    const len = str.length;
    for (let i = 0; i < len; i++) {
        hash ^= str.charCodeAt(i);
        hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);
    }
    return hash >>> 0;
}
export const b64 = {
    encode: (str) => btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (match, p1) => String.fromCharCode(Number.parseInt(p1, 16)))),
    decode: (str) => decodeURIComponent(atob(str)
        .split('')
        .map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))
        .join('')),
    serialize: (obj) => Object.keys(obj)
        .map(key => [key, b64.encode(String(obj[key]))].filter(Boolean).join(' '))
        .toString(),
    parse: (encoded) => {
        const kvPairs = encoded.split(',').map(kv => kv.split(' '));
        const decoded = {};
        for (const [key, value] of kvPairs) {
            if (key)
                decoded[key] = value ? b64.decode(value) : '';
        }
        return decoded;
    }
};
export function isBrowser() {
    return ![typeof window, typeof navigator].includes('undefined');
}
export function onLine() {
    return isBrowser() ? navigator.onLine : true;
}
export function isIOS() {
    return isBrowser() && /iPad|iPhone/.test(navigator.userAgent);
}
export function osVersion() {
    const m = /OS (\d+)_(\d+)_?(\d+)?/.exec(navigator.userAgent);
    if (m?.length)
        return m[1] + '.' + m[2] + '.' + m[3] || '0';
    return;
}
export function compareVersions(a, b) {
    return a.localeCompare(b, undefined, { numeric: true });
}
export function isBadIOS() {
    return isIOS() && compareVersions(osVersion() || '0.0', '15.3') < 0;
}
/**
 * [Big files upload error with iOS](https://github.com/kukhariev/ngx-uploadx/issues/316)
 * TODO: move to app
 */
export const iosOverride = isBadIOS()
    ? { chunkSize: 0, retryConfig: { shouldRetry: () => false } }
    : {};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvdXBsb2FkeC9saWIvdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsU0FBUyxTQUFTLENBQUMsSUFBWSxFQUFFLEVBQVU7SUFDekMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3JDLENBQUM7QUFFRCxNQUFNLFVBQVUsVUFBVSxDQUFDLEdBQVcsRUFBRSxJQUFZO0lBQ2xELElBQUksR0FBRyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUM7UUFBRSxPQUFPLEdBQUcsQ0FBQztJQUN2RSxJQUFJLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQztRQUFFLE9BQU8sU0FBUyxDQUFDLElBQUksRUFBRSxZQUFZLENBQUMsR0FBRyxHQUFHLENBQUM7SUFDeEUsSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUM7UUFBRSxPQUFPLFNBQVMsQ0FBQyxJQUFJLEVBQUUsaUNBQWlDLENBQUMsR0FBRyxHQUFHLENBQUM7SUFDNUYsT0FBTyxTQUFTLENBQUMsSUFBSSxFQUFFLHdDQUF3QyxDQUFDLEdBQUcsR0FBRyxDQUFDO0FBQ3pFLENBQUM7QUFFRCxNQUFNLFVBQVUsTUFBTSxDQUFPLEtBQTBCLEVBQUUsR0FBTTtJQUM3RCxPQUFPLEtBQUssWUFBWSxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO0FBQ3hELENBQUM7QUFFRCxNQUFNLENBQUMsTUFBTSxJQUFJLEdBQUcsQ0FBdUIsR0FBTSxFQUFFLEtBQVUsRUFBYyxFQUFFO0lBQzNFLE1BQU0sTUFB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Q0FBQyxHQUFHLENBQUMsQ0FBQztBQUN0RSxDQUFDO0FBRUQ7OztHQUdHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sV0FBVyxHQUFHLFFBQVEsRUFBRTtJQUNuQyxDQUFDLENBQUMsRUFBRSxTQUFTLEVBQUUsQ0FBQyxFQUFFLFdBQVcsRUFBRSxFQUFFLFdBQVcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtJQUM3RCxDQUFDLENBQUMsRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gc2FmZU1hdGNoKGJhc2U6IHN0cmluZywgcmU6IFJlZ0V4cCk6IHN0cmluZyB7XG4gIHJldHVybiAoYmFzZS5tYXRjaChyZSkgfHwgWycnXSlbMF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlVXJsKHVybDogc3RyaW5nLCBiYXNlOiBzdHJpbmcpOiBzdHJpbmcge1xuICBpZiAodXJsLmluZGV4T2YoJ2h0dHBzOi8vJykgKiB1cmwuaW5kZXhPZignaHR0cDovLycpID09PSAwKSByZXR1cm4gdXJsO1xuICBpZiAodXJsLmluZGV4T2YoJy8vJykgPT09IDApIHJldHVybiBzYWZlTWF0Y2goYmFzZSwgL14oaHR0cHM/OikvKSArIHVybDtcbiAgaWYgKHVybC5pbmRleE9mKCcvJykgPT09IDApIHJldHVybiBzYWZlTWF0Y2goYmFzZSwgL14oPzpodHRwcz86KT8oPzpcXC9cXC8pPyhbXlxcLz9dKykvKSArIHVybDtcbiAgcmV0dXJuIHNhZmVNYXRjaChiYXNlLCAvXig/Omh0dHBzPzopPyg/OlxcL1xcLyk/KFteXFwvP10rKT8oLipcXC8pLykgKyB1cmw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bmZ1bmM8VCwgVj4odmFsdWU6IFQgfCAoKHJlZjogVikgPT4gVCksIHJlZjogVik6IFQge1xuICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBGdW5jdGlvbiA/IHZhbHVlKHJlZikgOiB2YWx1ZTtcbn1cblxuZXhwb3J0IGNvbnN0IHBpY2sgPSA8VCwgSyBleHRlbmRzIGtleW9mIFQ+KG9iajogVCwgcHJvcHM6IEtbXSk6IFBpY2s8VCwgSz4gPT4ge1xuICBjb25zdCByZXN1bHQgPSB7fSBhcyBQaWNrPFQsIEs+O1xuICBwcm9wcy5mb3JFYWNoKGtleSA9PiAocmVzdWx0W2tleV0gPSBvYmpba2V5XSkpO1xuICByZXR1cm4gcmVzdWx0O1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzTnVtYmVyKHg/OiB1bmtub3duKTogeCBpcyBudW1iZXIge1xuICByZXR1cm4geCA9PT0gTnVtYmVyKHgpO1xufVxuXG4vKipcbiAqIDMyLWJpdCBGTlYtMWEgaGFzaCBmdW5jdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlSGFzaChzdHI6IHN0cmluZyk6IG51bWJlciB7XG4gIGxldCBoYXNoID0gMjE2NjEzNjI2MTtcbiAgY29uc3QgbGVuID0gc3RyLmxlbmd0aDtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgIGhhc2ggXj0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgaGFzaCArPSAoaGFzaCA8PCAxKSArIChoYXNoIDw8IDQpICsgKGhhc2ggPDwgNykgKyAoaGFzaCA8PCA4KSArIChoYXNoIDw8IDI0KTtcbiAgfVxuICByZXR1cm4gaGFzaCA+Pj4gMDtcbn1cblxuZXhwb3J0IGNvbnN0IGI2NCA9IHtcbiAgZW5jb2RlOiAoc3RyOiBzdHJpbmcpOiBzdHJpbmcgPT5cbiAgICBidG9hKFxuICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHN0cikucmVwbGFjZSgvJShbMC05QS1GXXsyfSkvZywgKG1hdGNoLCBwMSkgPT5cbiAgICAgICAgU3RyaW5nLmZyb21DaGFyQ29kZShOdW1iZXIucGFyc2VJbnQocDEsIDE2KSlcbiAgICAgIClcbiAgICApLFxuICBkZWNvZGU6IChzdHI6IHN0cmluZyk6IHN0cmluZyA9PlxuICAgIGRlY29kZVVSSUNvbXBvbmVudChcbiAgICAgIGF0b2Ioc3RyKVxuICAgICAgICAuc3BsaXQoJycpXG4gICAgICAgIC5tYXAoYyA9PiAnJScgKyAoJzAwJyArIGMuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC0yKSlcbiAgICAgICAgLmpvaW4oJycpXG4gICAgKSxcblxuICBzZXJpYWxpemU6IChvYmo6IFJlY29yZDxzdHJpbmcsIHVua25vd24+KTogc3RyaW5nID0+XG4gICAgT2JqZWN0LmtleXMob2JqKVxuICAgICAgLm1hcChrZXkgPT4gW2tleSwgYjY0LmVuY29kZShTdHJpbmcob2JqW2tleV0pKV0uZmlsdGVyKEJvb2xlYW4pLmpvaW4oJyAnKSlcbiAgICAgIC50b1N0cmluZygpLFxuXG4gIHBhcnNlOiAoZW5jb2RlZDogc3RyaW5nKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9PiB7XG4gICAgY29uc3Qga3ZQYWlycyA9IGVuY29kZWQuc3BsaXQoJywnKS5tYXAoa3YgPT4ga3Yuc3BsaXQoJyAnKSk7XG4gICAgY29uc3QgZGVjb2RlZDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIGt2UGFpcnMpIHtcbiAgICAgIGlmIChrZXkpIGRlY29kZWRba2V5XSA9IHZhbHVlID8gYjY0LmRlY29kZSh2YWx1ZSkgOiAnJztcbiAgICB9XG4gICAgcmV0dXJuIGRlY29kZWQ7XG4gIH1cbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0Jyb3dzZXIoKTogYm9vbGVhbiB7XG4gIHJldHVybiAhW3R5cGVvZiB3aW5kb3csIHR5cGVvZiBuYXZpZ2F0b3JdLmluY2x1ZGVzKCd1bmRlZmluZWQnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG9uTGluZSgpOiBib29sZWFuIHtcbiAgcmV0dXJuIGlzQnJvd3NlcigpID8gbmF2aWdhdG9yLm9uTGluZSA6IHRydWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0lPUygpOiBib29sZWFuIHtcbiAgcmV0dXJuIGlzQnJvd3NlcigpICYmIC9pUGFkfGlQaG9uZS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG9zVmVyc2lvbigpIHtcbiAgY29uc3QgbSA9IC9PUyAoXFxkKylfKFxcZCspXz8oXFxkKyk/Ly5leGVjKG5hdmlnYXRvci51c2VyQWdlbnQpO1xuICBpZiAobT8ubGVuZ3RoKSByZXR1cm4gbVsxXSArICcuJyArIG1bMl0gKyAnLicgKyBtWzNdIHx8ICcwJztcbiAgcmV0dXJuO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcGFyZVZlcnNpb25zKGE6IHN0cmluZywgYjogc3RyaW5nKTogbnVtYmVyIHtcbiAgcmV0dXJuIGEubG9jYWxlQ29tcGFyZShiLCB1bmRlZmluZWQsIHsgbnVtZXJpYzogdHJ1ZSB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQmFkSU9TKCkge1xuICByZXR1cm4gaXNJT1MoKSAmJiBjb21wYXJlVmVyc2lvbnMob3NWZXJzaW9uKCkgfHwgJzAuMCcsICcxNS4zJykgPCAwO1xufVxuXG4vKipcbiAqIFtCaWcgZmlsZXMgdXBsb2FkIGVycm9yIHdpdGggaU9TXShodHRwczovL2dpdGh1Yi5jb20va3VraGFyaWV2L25neC11cGxvYWR4L2lzc3Vlcy8zMTYpXG4gKiBUT0RPOiBtb3ZlIHRvIGFwcFxuICovXG5leHBvcnQgY29uc3QgaW9zT3ZlcnJpZGUgPSBpc0JhZElPUygpXG4gID8geyBjaHVua1NpemU6IDAsIHJldHJ5Q29uZmlnOiB7IHNob3VsZFJldHJ5OiAoKSA9PiBmYWxzZSB9IH1cbiAgOiB7fTtcbiJdfQ==