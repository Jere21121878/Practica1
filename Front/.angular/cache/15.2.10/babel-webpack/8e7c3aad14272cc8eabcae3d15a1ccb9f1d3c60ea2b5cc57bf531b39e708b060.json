{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/producto.service\";\nimport * as i3 from \"src/app/services/local.service\";\nimport * as i4 from \"@angular/material/snack-bar\";\nimport * as i5 from \"src/app/services/compra.service\";\nimport * as i6 from \"src/app/services/detalle-compra.service\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/material/button\";\nimport * as i9 from \"../navbar/navbar.component\";\nimport * as i10 from \"../store/ver-producto/ver-producto.component\";\nconst _c0 = function (a0) {\n  return {\n    \"show\": a0\n  };\n};\nfunction ComprarProductoComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"div\", 11)(2, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function ComprarProductoComponent_div_7_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.toggleDropdown());\n    });\n    i0.ɵɵtext(3, \"Cantidad\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 13);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 14)(7, \"ul\", 15)(8, \"li\")(9, \"a\", 16);\n    i0.ɵɵlistener(\"click\", function ComprarProductoComponent_div_7_Template_a_click_9_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.seleccionarCantidad(1));\n    });\n    i0.ɵɵtext(10, \"1\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"li\")(12, \"a\", 16);\n    i0.ɵɵlistener(\"click\", function ComprarProductoComponent_div_7_Template_a_click_12_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.seleccionarCantidad(2));\n    });\n    i0.ɵɵtext(13, \"2\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"li\")(15, \"a\", 16);\n    i0.ɵɵlistener(\"click\", function ComprarProductoComponent_div_7_Template_a_click_15_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.seleccionarCantidad(3));\n    });\n    i0.ɵɵtext(16, \"3\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"li\")(18, \"a\", 16);\n    i0.ɵɵlistener(\"click\", function ComprarProductoComponent_div_7_Template_a_click_18_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.seleccionarCantidad(4));\n    });\n    i0.ɵɵtext(19, \"4\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(20, \"li\")(21, \"a\", 16);\n    i0.ɵɵlistener(\"click\", function ComprarProductoComponent_div_7_Template_a_click_21_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.seleccionarCantidad(5));\n    });\n    i0.ɵɵtext(22, \"5\");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r0.cantidadSeleccionada);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, ctx_r0.showDropdown));\n  }\n}\nfunction ComprarProductoComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Vendido por la tienda: \", ctx_r1.localNombre, \" \");\n  }\n}\nexport class ComprarProductoComponent {\n  constructor(aRoute, productoService, localService, router, _snackBar, compraService, detalleCompraService // Inyecta el servicio de DetalleCompraService\n  ) {\n    this.aRoute = aRoute;\n    this.productoService = productoService;\n    this.localService = localService;\n    this.router = router;\n    this._snackBar = _snackBar;\n    this.compraService = compraService;\n    this.detalleCompraService = detalleCompraService;\n    this.localNombre = '';\n    this.cantidadSeleccionada = 1;\n    this.precioUnitario = 0;\n    this.subtotal = 0;\n    this.localId = -1; // Inicializar localId con un valor predeterminado\n    this.showDropdown = false;\n  }\n  ngOnInit() {\n    this.Id = Number(this.aRoute.snapshot.paramMap.get('id'));\n    this.productoService.getProducto(this.Id).subscribe(producto => {\n      if (producto.localId) {\n        this.localService.getLocal(producto.localId).subscribe(local => {\n          this.localNombre = local.nombreLo;\n          this.localId = local.id ?? -1;\n        });\n      }\n      this.precioUnitario = producto.precioVendido;\n    });\n  }\n  seleccionarCantidad(cantidad) {\n    this.cantidadSeleccionada = cantidad;\n    this.showDropdown = false; // Oculta la lista después de seleccionar un número\n  }\n\n  toggleDropdown() {\n    this.showDropdown = !this.showDropdown;\n  }\n  agregarAlCarrito() {\n    const userId = localStorage.getItem('userId');\n    if (!userId) {\n      console.error('El usuario no ha iniciado sesión.');\n      return;\n    }\n    const detalleCompra = {\n      productoId: this.Id.toString(),\n      cantidad: this.cantidadSeleccionada,\n      precioUnitario: this.precioUnitario,\n      localId: this.localId,\n      compradorId: userId,\n      subtotal: this.precioUnitario * this.cantidadSeleccionada\n    };\n    this.detalleCompraService.addDetalleCompra(detalleCompra).subscribe(response => {\n      console.log('Producto agregado al carrito:', response);\n      this.mensajeExito();\n    }, error => {\n      console.error('Error al agregar producto al carrito:', error);\n    });\n  }\n  mensajeExito() {\n    this._snackBar.open(`El producto fue añadido al carrito con éxito`, '', {\n      duration: 4000,\n      horizontalPosition: 'right'\n    });\n  }\n  comprarProducto() {\n    // Aquí podrías implementar la lógica para comprar el producto directamente en lugar de agregarlo al carrito\n  }\n  static #_ = this.ɵfac = function ComprarProductoComponent_Factory(t) {\n    return new (t || ComprarProductoComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ProductoService), i0.ɵɵdirectiveInject(i3.LocalService), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i4.MatSnackBar), i0.ɵɵdirectiveInject(i5.CompraService), i0.ɵɵdirectiveInject(i6.DetalleCompraService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ComprarProductoComponent,\n    selectors: [[\"app-comprar-producto\"]],\n    decls: 14,\n    vars: 3,\n    consts: [[1, \"dash\"], [1, \"main-and-sidebar\"], [1, \"main\"], [3, \"id\"], [1, \"sidebar\"], [\"class\", \"dropdown\", 4, \"ngIf\"], [1, \"button-container\"], [\"mat-raised-button\", \"\", \"color\", \"accent\"], [\"mat-stroked-button\", \"\", \"color\", \"accent\", 3, \"click\"], [4, \"ngIf\"], [1, \"dropdown\"], [1, \"quantity-container\"], [1, \"dropbtn\", 3, \"click\"], [1, \"selected-quantity\", \"elegant-frame\"], [1, \"dropdown-content\", 3, \"ngClass\"], [1, \"number-list\"], [\"href\", \"javascript:void(0);\", 3, \"click\"]],\n    template: function ComprarProductoComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"body\")(1, \"div\", 0);\n        i0.ɵɵelement(2, \"app-navbar\");\n        i0.ɵɵelementStart(3, \"div\", 1)(4, \"main\", 2);\n        i0.ɵɵelement(5, \"app-ver-producto\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 4);\n        i0.ɵɵtemplate(7, ComprarProductoComponent_div_7_Template, 23, 4, \"div\", 5);\n        i0.ɵɵelementStart(8, \"div\", 6)(9, \"button\", 7);\n        i0.ɵɵtext(10, \"Comprar\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"button\", 8);\n        i0.ɵɵlistener(\"click\", function ComprarProductoComponent_Template_button_click_11_listener() {\n          return ctx.agregarAlCarrito();\n        });\n        i0.ɵɵtext(12, \"Agregar al carrito\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(13, ComprarProductoComponent_div_13_Template, 2, 1, \"div\", 9);\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"id\", ctx.Id);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", !ctx.showDropdown);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", ctx.localNombre);\n      }\n    },\n    dependencies: [i7.NgClass, i7.NgIf, i8.MatButton, i9.NavbarComponent, i10.VerProductoComponent],\n    styles: [\".dash[_ngcontent-%COMP%] {\\r\\n    display: flex; \\r\\n    flex-direction: column; \\r\\n  }\\r\\n  \\r\\n  .main-and-sidebar[_ngcontent-%COMP%] {\\r\\n    display: flex; \\r\\n    flex: 1; \\r\\n  }\\r\\n  \\r\\n  .sidebar[_ngcontent-%COMP%] {\\r\\n    order: 2;\\r\\n    flex: 0 0 300px;\\r\\n    border: 1px solid #ccc;\\r\\n    border-radius: 4px;\\r\\n    box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);\\r\\n    padding: 20px;\\r\\n  }\\r\\n  \\r\\n  .dropdown[_ngcontent-%COMP%] {\\r\\n    position: relative;\\r\\n    display: inline-block;\\r\\n  }\\r\\n  \\r\\n  .dropbtn[_ngcontent-%COMP%] {\\r\\n    background-color: #4CAF50;\\r\\n    color: white;\\r\\n    padding: 10px;\\r\\n    font-size: 16px;\\r\\n    border: none;\\r\\n  }\\r\\n  \\r\\n  .dropdown-content[_ngcontent-%COMP%] {\\r\\n    display: none;\\r\\n    position: absolute;\\r\\n    background-color: #f9f9f9;\\r\\n    min-width: 160px;\\r\\n    box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);\\r\\n    z-index: 1;\\r\\n  }\\r\\n  \\r\\n  .dropdown-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\\r\\n    color: black;\\r\\n    padding: 12px 16px;\\r\\n    text-decoration: none;\\r\\n    display: block;\\r\\n  }\\r\\n  \\r\\n  .dropdown-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover {\\r\\n    background-color: #f1f1f1;\\r\\n  }\\r\\n  \\r\\n  .dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%] {\\r\\n    display: block;\\r\\n  }\\r\\n  \\r\\n  .number-list[_ngcontent-%COMP%] {\\r\\n    list-style: none;\\r\\n    padding: 0;\\r\\n  }\\r\\n  \\r\\n  .number-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] {\\r\\n    margin-bottom: 10px;\\r\\n  }\\r\\n  \\r\\n  .button-container[_ngcontent-%COMP%] {\\r\\n    margin-top: 20px;\\r\\n    display: flex;\\r\\n    flex-direction: column; \\r\\n  }\\r\\n  .show[_ngcontent-%COMP%] {\\r\\n    display: block !important;\\r\\n  }\\r\\n  .dropdown[_ngcontent-%COMP%] {\\r\\n    display: flex;\\r\\n    align-items: center; \\r\\n  }\\r\\n  \\r\\n  .quantity-container[_ngcontent-%COMP%] {\\r\\n    display: flex;\\r\\n    align-items: center; \\r\\n  }\\r\\n  \\r\\n  .elegant-frame[_ngcontent-%COMP%] {\\r\\n    border: 1px solid #ccc;\\r\\n    border-radius: 4px;\\r\\n    padding: 5px 10px;\\r\\n    margin-left: 10px;\\r\\n  }\\r\\n\\r\\n  \\r\\n  \\r\\n  .button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\r\\n    margin-bottom: 10px; \\r\\n  }\\r\\n  \\r\\n  .main[_ngcontent-%COMP%] {\\r\\n    order: 1; \\r\\n    flex: 1;\\r\\n    margin-top: 20px;\\r\\n    margin-left: 20px;\\r\\n    margin-right: 20px;\\r\\n  }\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9jb21wcmFyLXByb2R1Y3RvL2NvbXByYXItcHJvZHVjdG8uY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLGFBQWEsRUFBRSw0REFBNEQ7SUFDM0Usc0JBQXNCLEVBQUUsdUNBQXVDO0VBQ2pFOztFQUVBO0lBQ0UsYUFBYSxFQUFFLDREQUE0RDtJQUMzRSxPQUFPLEVBQUUsMkRBQTJEO0VBQ3RFOztFQUVBO0lBQ0UsUUFBUTtJQUNSLGVBQWU7SUFDZixzQkFBc0I7SUFDdEIsa0JBQWtCO0lBQ2xCLDBDQUEwQztJQUMxQyxhQUFhO0VBQ2Y7O0VBRUE7SUFDRSxrQkFBa0I7SUFDbEIscUJBQXFCO0VBQ3ZCOztFQUVBO0lBQ0UseUJBQXlCO0lBQ3pCLFlBQVk7SUFDWixhQUFhO0lBQ2IsZUFBZTtJQUNmLFlBQVk7RUFDZDs7RUFFQTtJQUNFLGFBQWE7SUFDYixrQkFBa0I7SUFDbEIseUJBQXlCO0lBQ3pCLGdCQUFnQjtJQUNoQiwrQ0FBK0M7SUFDL0MsVUFBVTtFQUNaOztFQUVBO0lBQ0UsWUFBWTtJQUNaLGtCQUFrQjtJQUNsQixxQkFBcUI7SUFDckIsY0FBYztFQUNoQjs7RUFFQTtJQUNFLHlCQUF5QjtFQUMzQjs7RUFFQTtJQUNFLGNBQWM7RUFDaEI7O0VBRUE7SUFDRSxnQkFBZ0I7SUFDaEIsVUFBVTtFQUNaOztFQUVBO0lBQ0UsbUJBQW1CO0VBQ3JCOztFQUVBO0lBQ0UsZ0JBQWdCO0lBQ2hCLGFBQWE7SUFDYixzQkFBc0IsRUFBRSx1Q0FBdUM7RUFDakU7RUFDQTtJQUNFLHlCQUF5QjtFQUMzQjtFQUNBO0lBQ0UsYUFBYTtJQUNiLG1CQUFtQixFQUFFLHNEQUFzRDtFQUM3RTs7RUFFQTtJQUNFLGFBQWE7SUFDYixtQkFBbUIsRUFBRSxzREFBc0Q7RUFDN0U7O0VBRUE7SUFDRSxzQkFBc0I7SUFDdEIsa0JBQWtCO0lBQ2xCLGlCQUFpQjtJQUNqQixpQkFBaUI7RUFDbkI7Ozs7RUFJQTtJQUNFLG1CQUFtQixFQUFFLGdDQUFnQztFQUN2RDs7RUFFQTtJQUNFLFFBQVEsRUFBRSx3Q0FBd0M7SUFDbEQsT0FBTztJQUNQLGdCQUFnQjtJQUNoQixpQkFBaUI7SUFDakIsa0JBQWtCO0VBQ3BCIiwic291cmNlc0NvbnRlbnQiOlsiLmRhc2gge1xyXG4gICAgZGlzcGxheTogZmxleDsgLyogSGFjZXIgcXVlIGxvcyBlbGVtZW50b3MgaGlqb3Mgc2UgY29tcG9ydGVuIGNvbW8gZmxleGJveCAqL1xyXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgLyogQXBpbGFyIGxvcyBlbGVtZW50b3MgdmVydGljYWxtZW50ZSAqL1xyXG4gIH1cclxuICBcclxuICAubWFpbi1hbmQtc2lkZWJhciB7XHJcbiAgICBkaXNwbGF5OiBmbGV4OyAvKiBIYWNlciBxdWUgbG9zIGVsZW1lbnRvcyBoaWpvcyBzZSBjb21wb3J0ZW4gY29tbyBmbGV4Ym94ICovXHJcbiAgICBmbGV4OiAxOyAvKiBFbCBjdWVycG8geSBlbCBzaWRlYmFyIGNvbXBhcnRpcsODwqFuIGVsIGVzcGFjaW8gcmVzdGFudGUgKi9cclxuICB9XHJcbiAgXHJcbiAgLnNpZGViYXIge1xyXG4gICAgb3JkZXI6IDI7XHJcbiAgICBmbGV4OiAwIDAgMzAwcHg7XHJcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gICAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gICAgYm94LXNoYWRvdzogMHB4IDJweCA1cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xyXG4gICAgcGFkZGluZzogMjBweDtcclxuICB9XHJcbiAgXHJcbiAgLmRyb3Bkb3duIHtcclxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcclxuICB9XHJcbiAgXHJcbiAgLmRyb3BidG4ge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzRDQUY1MDtcclxuICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgIHBhZGRpbmc6IDEwcHg7XHJcbiAgICBmb250LXNpemU6IDE2cHg7XHJcbiAgICBib3JkZXI6IG5vbmU7XHJcbiAgfVxyXG4gIFxyXG4gIC5kcm9wZG93bi1jb250ZW50IHtcclxuICAgIGRpc3BsYXk6IG5vbmU7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjlmOWY5O1xyXG4gICAgbWluLXdpZHRoOiAxNjBweDtcclxuICAgIGJveC1zaGFkb3c6IDBweCA4cHggMTZweCAwcHggcmdiYSgwLCAwLCAwLCAwLjIpO1xyXG4gICAgei1pbmRleDogMTtcclxuICB9XHJcbiAgXHJcbiAgLmRyb3Bkb3duLWNvbnRlbnQgYSB7XHJcbiAgICBjb2xvcjogYmxhY2s7XHJcbiAgICBwYWRkaW5nOiAxMnB4IDE2cHg7XHJcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XHJcbiAgICBkaXNwbGF5OiBibG9jaztcclxuICB9XHJcbiAgXHJcbiAgLmRyb3Bkb3duLWNvbnRlbnQgYTpob3ZlciB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjFmMWYxO1xyXG4gIH1cclxuICBcclxuICAuZHJvcGRvd246aG92ZXIgLmRyb3Bkb3duLWNvbnRlbnQge1xyXG4gICAgZGlzcGxheTogYmxvY2s7XHJcbiAgfVxyXG4gIFxyXG4gIC5udW1iZXItbGlzdCB7XHJcbiAgICBsaXN0LXN0eWxlOiBub25lO1xyXG4gICAgcGFkZGluZzogMDtcclxuICB9XHJcbiAgXHJcbiAgLm51bWJlci1saXN0IGxpIHtcclxuICAgIG1hcmdpbi1ib3R0b206IDEwcHg7XHJcbiAgfVxyXG4gIFxyXG4gIC5idXR0b24tY29udGFpbmVyIHtcclxuICAgIG1hcmdpbi10b3A6IDIwcHg7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgLyogQXBpbGFyIGxvcyBlbGVtZW50b3MgdmVydGljYWxtZW50ZSAqL1xyXG4gIH1cclxuICAuc2hvdyB7XHJcbiAgICBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50O1xyXG4gIH1cclxuICAuZHJvcGRvd24ge1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7IC8qIENlbnRyYSB2ZXJ0aWNhbG1lbnRlIGxvcyBlbGVtZW50b3MgZGVsIGNvbnRlbmVkb3IgKi9cclxuICB9XHJcbiAgXHJcbiAgLnF1YW50aXR5LWNvbnRhaW5lciB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjsgLyogQ2VudHJhIHZlcnRpY2FsbWVudGUgbG9zIGVsZW1lbnRvcyBkZWwgY29udGVuZWRvciAqL1xyXG4gIH1cclxuICBcclxuICAuZWxlZ2FudC1mcmFtZSB7XHJcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gICAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gICAgcGFkZGluZzogNXB4IDEwcHg7XHJcbiAgICBtYXJnaW4tbGVmdDogMTBweDtcclxuICB9XHJcblxyXG4gIFxyXG4gIFxyXG4gIC5idXR0b24tY29udGFpbmVyIGJ1dHRvbiB7XHJcbiAgICBtYXJnaW4tYm90dG9tOiAxMHB4OyAvKiBFc3BhY2lhZG8gZW50cmUgbG9zIGJvdG9uZXMgKi9cclxuICB9XHJcbiAgXHJcbiAgLm1haW4ge1xyXG4gICAgb3JkZXI6IDE7IC8qIENvbG9jYXIgZWwgY3VlcnBvIGFudGVzIGRlbCBzaWRlYmFyICovXHJcbiAgICBmbGV4OiAxO1xyXG4gICAgbWFyZ2luLXRvcDogMjBweDtcclxuICAgIG1hcmdpbi1sZWZ0OiAyMHB4O1xyXG4gICAgbWFyZ2luLXJpZ2h0OiAyMHB4O1xyXG4gIH0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["i0","ComprarProductoComponent","constructor","aRoute","productoService","localService","router","_snackBar","compraService","detalleCompraService","ngOnInit","Id","Number","snapshot","paramMap","get","getProducto","subscribe","producto","localId","getLocal","local","localNombre","nombreLo","id","precioUnitario","precioVendido","seleccionarCantidad","cantidad","cantidadSeleccionada","showDropdown","toggleDropdown","agregarAlCarrito","userId","localStorage","getItem","console","error","detalleCompra","productoId","toString","compradorId","subtotal","addDetalleCompra","response","log","mensajeExito","open","duration","horizontalPosition","comprarProducto","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\54351\\Desktop\\Practica1\\Front\\src\\app\\components\\comprar-producto\\comprar-producto.component.html","C:\\Users\\54351\\Desktop\\Practica1\\Front\\src\\app\\components\\comprar-producto\\comprar-producto.component.ts"],"sourcesContent":["<body>\n  <div class=\"dash\">\n    <app-navbar></app-navbar>\n\n    <div class=\"main-and-sidebar\">\n      <!-- BODY -->\n      <main class=\"main\">\n        <app-ver-producto [id]=\"Id\"></app-ver-producto>\n      </main>\n\n      <!-- SIDEBAR -->\n      <div class=\"sidebar\">\n        <!-- Lista desplegable -->\n        <div class=\"dropdown\" *ngIf=\"!showDropdown\">\n          <div class=\"quantity-container\">\n            <button class=\"dropbtn\" (click)=\"toggleDropdown()\">Cantidad</button>\n            <div class=\"selected-quantity elegant-frame\">{{ cantidadSeleccionada }}</div>\n          </div>\n          <div class=\"dropdown-content\" [ngClass]=\"{'show': showDropdown}\">\n            <ul class=\"number-list\">\n              <li><a href=\"javascript:void(0);\" (click)=\"seleccionarCantidad(1)\">1</a></li>\n              <li><a href=\"javascript:void(0);\" (click)=\"seleccionarCantidad(2)\">2</a></li>\n              <li><a href=\"javascript:void(0);\" (click)=\"seleccionarCantidad(3)\">3</a></li>\n              <li><a href=\"javascript:void(0);\" (click)=\"seleccionarCantidad(4)\">4</a></li>\n              <li><a href=\"javascript:void(0);\" (click)=\"seleccionarCantidad(5)\">5</a></li>\n            </ul>\n            \n          </div>\n        </div>\n        <!-- Botones adicionales -->\n        <div class=\"button-container\">\n          <button mat-raised-button color=\"accent\" >Comprar</button>\n          <button mat-stroked-button color=\"accent\" (click)=\"agregarAlCarrito()\">Agregar al carrito</button>\n        </div>\n        <div *ngIf=\"localNombre\">\n          Vendido por la tienda: {{ localNombre }}\n        </div>\n      </div>\n    </div>\n  </div>\n</body>","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ProductoService } from 'src/app/services/producto.service';\nimport { LocalService } from 'src/app/services/local.service';\nimport { DetalleCompraService } from 'src/app/services/detalle-compra.service'; // Importa el servicio y la interfaz de DetalleCompra\nimport { CompraService } from 'src/app/services/compra.service';\nimport { DetalleCompra } from 'src/app/interfaces/detalle-compra';\nimport { MatSnackBar } from '@angular/material/snack-bar';\n\n@Component({\n  selector: 'app-comprar-producto',\n  templateUrl: './comprar-producto.component.html',\n  styleUrls: ['./comprar-producto.component.css']\n})\nexport class ComprarProductoComponent implements OnInit {\n  Id!: number;\n  localNombre: string = '';\n  cantidadSeleccionada: number = 1;\n  precioUnitario: number = 0;\n  subtotal: number = 0;\n  localId: number = -1; // Inicializar localId con un valor predeterminado\n  showDropdown: boolean = false;\n\n  constructor(\n    private aRoute: ActivatedRoute,\n    private productoService: ProductoService,\n    private localService: LocalService,\n    private router: Router,\n    private _snackBar: MatSnackBar,\n\n    private compraService: CompraService,\n    private detalleCompraService: DetalleCompraService // Inyecta el servicio de DetalleCompraService\n  ) {}\n\n  ngOnInit() {\n    this.Id = Number(this.aRoute.snapshot.paramMap.get('id'));\n    this.productoService.getProducto(this.Id).subscribe(producto => {\n      if (producto.localId) {\n        this.localService.getLocal(producto.localId).subscribe(local => {\n          this.localNombre = local.nombreLo;\n          this.localId = local.id ?? -1;\n        });\n      }\n      this.precioUnitario = producto.precioVendido;\n    });\n  }\n  seleccionarCantidad(cantidad: number) {\n    this.cantidadSeleccionada = cantidad;\n    this.showDropdown = false; // Oculta la lista después de seleccionar un número\n  }\n  \n  toggleDropdown() {\n    this.showDropdown = !this.showDropdown;\n  }\n\n  agregarAlCarrito() {\n    const userId = localStorage.getItem('userId');\n    if (!userId) {\n      console.error('El usuario no ha iniciado sesión.');\n      return;\n    }\n  \n    const detalleCompra: DetalleCompra = {\n      productoId: this.Id.toString(), // Convertir this.Id a una cadena de texto\n      cantidad: this.cantidadSeleccionada,\n      precioUnitario: this.precioUnitario,\n      localId: this.localId,\n      compradorId: userId,\n      subtotal: this.precioUnitario * this.cantidadSeleccionada\n    };\n  \n    this.detalleCompraService.addDetalleCompra(detalleCompra).subscribe(\n      response => {\n        console.log('Producto agregado al carrito:', response);\n        this.mensajeExito();\n      },\n      error => {\n        console.error('Error al agregar producto al carrito:', error);\n      }\n    );\n  }\n  \n  mensajeExito() {\n    this._snackBar.open(`El producto fue añadido al carrito con éxito`,'', {\n      duration: 4000,\n      horizontalPosition: 'right',\n    });\n  }\n  comprarProducto() {\n    // Aquí podrías implementar la lógica para comprar el producto directamente en lugar de agregarlo al carrito\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}