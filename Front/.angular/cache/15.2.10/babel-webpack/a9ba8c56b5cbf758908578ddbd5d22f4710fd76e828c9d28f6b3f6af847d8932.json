{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/producto.service\";\nimport * as i3 from \"src/app/services/local.service\";\nimport * as i4 from \"@angular/material/snack-bar\";\nimport * as i5 from \"src/app/services/compra.service\";\nimport * as i6 from \"src/app/services/detalle-compra.service\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/material/button\";\nimport * as i9 from \"../navbar/navbar.component\";\nimport * as i10 from \"../store/ver-producto/ver-producto.component\";\nfunction ComprarProductoComponent_div_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Vendido por la tienda: \", ctx_r0.localNombre, \" \");\n  }\n}\nexport class ComprarProductoComponent {\n  constructor(aRoute, productoService, localService, router, _snackBar, compraService, detalleCompraService // Inyecta el servicio de DetalleCompraService\n  ) {\n    this.aRoute = aRoute;\n    this.productoService = productoService;\n    this.localService = localService;\n    this.router = router;\n    this._snackBar = _snackBar;\n    this.compraService = compraService;\n    this.detalleCompraService = detalleCompraService;\n    this.localNombre = '';\n    this.cantidadSeleccionada = 1;\n    this.precioUnitario = 0;\n    this.subtotal = 0;\n    this.localId = -1; // Inicializar localId con un valor predeterminado\n  }\n\n  ngOnInit() {\n    this.Id = Number(this.aRoute.snapshot.paramMap.get('id'));\n    this.productoService.getProducto(this.Id).subscribe(producto => {\n      if (producto.localId) {\n        this.localService.getLocal(producto.localId).subscribe(local => {\n          this.localNombre = local.nombreLo;\n          this.localId = local.id ?? -1;\n        });\n      }\n      this.precioUnitario = producto.precioVendido;\n    });\n  }\n  agregarAlCarrito() {\n    const userId = localStorage.getItem('userId'); // Obtén el ID del usuario desde localStorage\n    if (!userId) {\n      console.error('El usuario no ha iniciado sesión.');\n      // Aquí podrías mostrar un mensaje al usuario para iniciar sesión o redirigirlo a la página de inicio de sesión\n      return;\n    }\n    const detalleCompra = {\n      productoId: this.Id,\n      cantidad: this.cantidadSeleccionada,\n      precioUnitario: this.precioUnitario,\n      localId: this.localId,\n      compradorId: userId,\n      subtotal: this.precioUnitario * this.cantidadSeleccionada\n    };\n    // Llama al servicio para agregar el detalle de compra al carrito\n    this.detalleCompraService.addDetalleCompra(detalleCompra).subscribe(response => {\n      console.log('Producto agregado al carrito:', response);\n      // Muestra el mensaje de éxito\n      this.mensajeExito();\n      // Aquí podrías redirigir al usuario a la página del carrito o mostrar un mensaje de éxito\n    }, error => {\n      console.error('Error al agregar producto al carrito:', error);\n      // Aquí podrías mostrar un mensaje de error al usuario\n    });\n  }\n\n  mensajeExito() {\n    this._snackBar.open(`El producto fue añadido al carrito con éxito`, '', {\n      duration: 4000,\n      horizontalPosition: 'right'\n    });\n  }\n  comprarProducto() {\n    // Aquí podrías implementar la lógica para comprar el producto directamente en lugar de agregarlo al carrito\n  }\n  static #_ = this.ɵfac = function ComprarProductoComponent_Factory(t) {\n    return new (t || ComprarProductoComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ProductoService), i0.ɵɵdirectiveInject(i3.LocalService), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i4.MatSnackBar), i0.ɵɵdirectiveInject(i5.CompraService), i0.ɵɵdirectiveInject(i6.DetalleCompraService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ComprarProductoComponent,\n    selectors: [[\"app-comprar-producto\"]],\n    decls: 33,\n    vars: 2,\n    consts: [[1, \"dash\"], [1, \"main-and-sidebar\"], [1, \"main\"], [3, \"id\"], [1, \"sidebar\"], [1, \"dropdown\"], [1, \"dropbtn\"], [1, \"dropdown-content\"], [1, \"number-list\"], [\"href\", \"#\"], [1, \"button-container\"], [\"mat-raised-button\", \"\", \"color\", \"accent\"], [\"mat-stroked-button\", \"\", \"color\", \"accent\", 3, \"click\"], [4, \"ngIf\"]],\n    template: function ComprarProductoComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"body\")(1, \"div\", 0);\n        i0.ɵɵelement(2, \"app-navbar\");\n        i0.ɵɵelementStart(3, \"div\", 1)(4, \"main\", 2);\n        i0.ɵɵelement(5, \"app-ver-producto\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 4)(7, \"div\", 5)(8, \"button\", 6);\n        i0.ɵɵtext(9, \"Cantidad\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 7)(11, \"ul\", 8)(12, \"li\")(13, \"a\", 9);\n        i0.ɵɵtext(14, \"1\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"li\")(16, \"a\", 9);\n        i0.ɵɵtext(17, \"2\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"li\")(19, \"a\", 9);\n        i0.ɵɵtext(20, \"3\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(21, \"li\")(22, \"a\", 9);\n        i0.ɵɵtext(23, \"4\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(24, \"li\")(25, \"a\", 9);\n        i0.ɵɵtext(26, \"5\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(27, \"div\", 10)(28, \"button\", 11);\n        i0.ɵɵtext(29, \"Comprar\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"button\", 12);\n        i0.ɵɵlistener(\"click\", function ComprarProductoComponent_Template_button_click_30_listener() {\n          return ctx.agregarAlCarrito();\n        });\n        i0.ɵɵtext(31, \"Agregar al carrito\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(32, ComprarProductoComponent_div_32_Template, 2, 1, \"div\", 13);\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"id\", ctx.Id);\n        i0.ɵɵadvance(27);\n        i0.ɵɵproperty(\"ngIf\", ctx.localNombre);\n      }\n    },\n    dependencies: [i7.NgIf, i8.MatButton, i9.NavbarComponent, i10.VerProductoComponent],\n    styles: [\".dash[_ngcontent-%COMP%] {\\r\\n    display: flex; \\r\\n    flex-direction: column; \\r\\n  }\\r\\n  \\r\\n  .main-and-sidebar[_ngcontent-%COMP%] {\\r\\n    display: flex; \\r\\n    flex: 1; \\r\\n  }\\r\\n  \\r\\n  .sidebar[_ngcontent-%COMP%] {\\r\\n    order: 2;\\r\\n    flex: 0 0 300px;\\r\\n    border: 1px solid #ccc;\\r\\n    border-radius: 4px;\\r\\n    box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);\\r\\n    padding: 20px;\\r\\n  }\\r\\n  \\r\\n  .dropdown[_ngcontent-%COMP%] {\\r\\n    position: relative;\\r\\n    display: inline-block;\\r\\n  }\\r\\n  \\r\\n  .dropbtn[_ngcontent-%COMP%] {\\r\\n    background-color: #4CAF50;\\r\\n    color: white;\\r\\n    padding: 10px;\\r\\n    font-size: 16px;\\r\\n    border: none;\\r\\n  }\\r\\n  \\r\\n  .dropdown-content[_ngcontent-%COMP%] {\\r\\n    display: none;\\r\\n    position: absolute;\\r\\n    background-color: #f9f9f9;\\r\\n    min-width: 160px;\\r\\n    box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);\\r\\n    z-index: 1;\\r\\n  }\\r\\n  \\r\\n  .dropdown-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\\r\\n    color: black;\\r\\n    padding: 12px 16px;\\r\\n    text-decoration: none;\\r\\n    display: block;\\r\\n  }\\r\\n  \\r\\n  .dropdown-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover {\\r\\n    background-color: #f1f1f1;\\r\\n  }\\r\\n  \\r\\n  .dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%] {\\r\\n    display: block;\\r\\n  }\\r\\n  \\r\\n  .number-list[_ngcontent-%COMP%] {\\r\\n    list-style: none;\\r\\n    padding: 0;\\r\\n  }\\r\\n  \\r\\n  .number-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] {\\r\\n    margin-bottom: 10px;\\r\\n  }\\r\\n  \\r\\n  .button-container[_ngcontent-%COMP%] {\\r\\n    margin-top: 20px;\\r\\n    display: flex;\\r\\n    flex-direction: column; \\r\\n  }\\r\\n  \\r\\n  .button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\r\\n    margin-bottom: 10px; \\r\\n  }\\r\\n  \\r\\n  .main[_ngcontent-%COMP%] {\\r\\n    order: 1; \\r\\n    flex: 1;\\r\\n    margin-top: 20px;\\r\\n    margin-left: 20px;\\r\\n    margin-right: 20px;\\r\\n  }\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9jb21wcmFyLXByb2R1Y3RvL2NvbXByYXItcHJvZHVjdG8uY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLGFBQWEsRUFBRSw0REFBNEQ7SUFDM0Usc0JBQXNCLEVBQUUsdUNBQXVDO0VBQ2pFOztFQUVBO0lBQ0UsYUFBYSxFQUFFLDREQUE0RDtJQUMzRSxPQUFPLEVBQUUsMkRBQTJEO0VBQ3RFOztFQUVBO0lBQ0UsUUFBUTtJQUNSLGVBQWU7SUFDZixzQkFBc0I7SUFDdEIsa0JBQWtCO0lBQ2xCLDBDQUEwQztJQUMxQyxhQUFhO0VBQ2Y7O0VBRUE7SUFDRSxrQkFBa0I7SUFDbEIscUJBQXFCO0VBQ3ZCOztFQUVBO0lBQ0UseUJBQXlCO0lBQ3pCLFlBQVk7SUFDWixhQUFhO0lBQ2IsZUFBZTtJQUNmLFlBQVk7RUFDZDs7RUFFQTtJQUNFLGFBQWE7SUFDYixrQkFBa0I7SUFDbEIseUJBQXlCO0lBQ3pCLGdCQUFnQjtJQUNoQiwrQ0FBK0M7SUFDL0MsVUFBVTtFQUNaOztFQUVBO0lBQ0UsWUFBWTtJQUNaLGtCQUFrQjtJQUNsQixxQkFBcUI7SUFDckIsY0FBYztFQUNoQjs7RUFFQTtJQUNFLHlCQUF5QjtFQUMzQjs7RUFFQTtJQUNFLGNBQWM7RUFDaEI7O0VBRUE7SUFDRSxnQkFBZ0I7SUFDaEIsVUFBVTtFQUNaOztFQUVBO0lBQ0UsbUJBQW1CO0VBQ3JCOztFQUVBO0lBQ0UsZ0JBQWdCO0lBQ2hCLGFBQWE7SUFDYixzQkFBc0IsRUFBRSx1Q0FBdUM7RUFDakU7O0VBRUE7SUFDRSxtQkFBbUIsRUFBRSxnQ0FBZ0M7RUFDdkQ7O0VBRUE7SUFDRSxRQUFRLEVBQUUsd0NBQXdDO0lBQ2xELE9BQU87SUFDUCxnQkFBZ0I7SUFDaEIsaUJBQWlCO0lBQ2pCLGtCQUFrQjtFQUNwQiIsInNvdXJjZXNDb250ZW50IjpbIi5kYXNoIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7IC8qIEhhY2VyIHF1ZSBsb3MgZWxlbWVudG9zIGhpam9zIHNlIGNvbXBvcnRlbiBjb21vIGZsZXhib3ggKi9cclxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IC8qIEFwaWxhciBsb3MgZWxlbWVudG9zIHZlcnRpY2FsbWVudGUgKi9cclxuICB9XHJcbiAgXHJcbiAgLm1haW4tYW5kLXNpZGViYXIge1xyXG4gICAgZGlzcGxheTogZmxleDsgLyogSGFjZXIgcXVlIGxvcyBlbGVtZW50b3MgaGlqb3Mgc2UgY29tcG9ydGVuIGNvbW8gZmxleGJveCAqL1xyXG4gICAgZmxleDogMTsgLyogRWwgY3VlcnBvIHkgZWwgc2lkZWJhciBjb21wYXJ0aXLDg8KhbiBlbCBlc3BhY2lvIHJlc3RhbnRlICovXHJcbiAgfVxyXG4gIFxyXG4gIC5zaWRlYmFyIHtcclxuICAgIG9yZGVyOiAyO1xyXG4gICAgZmxleDogMCAwIDMwMHB4O1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgI2NjYztcclxuICAgIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICAgIGJveC1zaGFkb3c6IDBweCAycHggNXB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcclxuICAgIHBhZGRpbmc6IDIwcHg7XHJcbiAgfVxyXG4gIFxyXG4gIC5kcm9wZG93biB7XHJcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcbiAgfVxyXG4gIFxyXG4gIC5kcm9wYnRuIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6ICM0Q0FGNTA7XHJcbiAgICBjb2xvcjogd2hpdGU7XHJcbiAgICBwYWRkaW5nOiAxMHB4O1xyXG4gICAgZm9udC1zaXplOiAxNnB4O1xyXG4gICAgYm9yZGVyOiBub25lO1xyXG4gIH1cclxuICBcclxuICAuZHJvcGRvd24tY29udGVudCB7XHJcbiAgICBkaXNwbGF5OiBub25lO1xyXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2Y5ZjlmOTtcclxuICAgIG1pbi13aWR0aDogMTYwcHg7XHJcbiAgICBib3gtc2hhZG93OiAwcHggOHB4IDE2cHggMHB4IHJnYmEoMCwgMCwgMCwgMC4yKTtcclxuICAgIHotaW5kZXg6IDE7XHJcbiAgfVxyXG4gIFxyXG4gIC5kcm9wZG93bi1jb250ZW50IGEge1xyXG4gICAgY29sb3I6IGJsYWNrO1xyXG4gICAgcGFkZGluZzogMTJweCAxNnB4O1xyXG4gICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xyXG4gICAgZGlzcGxheTogYmxvY2s7XHJcbiAgfVxyXG4gIFxyXG4gIC5kcm9wZG93bi1jb250ZW50IGE6aG92ZXIge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2YxZjFmMTtcclxuICB9XHJcbiAgXHJcbiAgLmRyb3Bkb3duOmhvdmVyIC5kcm9wZG93bi1jb250ZW50IHtcclxuICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gIH1cclxuICBcclxuICAubnVtYmVyLWxpc3Qge1xyXG4gICAgbGlzdC1zdHlsZTogbm9uZTtcclxuICAgIHBhZGRpbmc6IDA7XHJcbiAgfVxyXG4gIFxyXG4gIC5udW1iZXItbGlzdCBsaSB7XHJcbiAgICBtYXJnaW4tYm90dG9tOiAxMHB4O1xyXG4gIH1cclxuICBcclxuICAuYnV0dG9uLWNvbnRhaW5lciB7XHJcbiAgICBtYXJnaW4tdG9wOiAyMHB4O1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IC8qIEFwaWxhciBsb3MgZWxlbWVudG9zIHZlcnRpY2FsbWVudGUgKi9cclxuICB9XHJcbiAgXHJcbiAgLmJ1dHRvbi1jb250YWluZXIgYnV0dG9uIHtcclxuICAgIG1hcmdpbi1ib3R0b206IDEwcHg7IC8qIEVzcGFjaWFkbyBlbnRyZSBsb3MgYm90b25lcyAqL1xyXG4gIH1cclxuICBcclxuICAubWFpbiB7XHJcbiAgICBvcmRlcjogMTsgLyogQ29sb2NhciBlbCBjdWVycG8gYW50ZXMgZGVsIHNpZGViYXIgKi9cclxuICAgIGZsZXg6IDE7XHJcbiAgICBtYXJnaW4tdG9wOiAyMHB4O1xyXG4gICAgbWFyZ2luLWxlZnQ6IDIwcHg7XHJcbiAgICBtYXJnaW4tcmlnaHQ6IDIwcHg7XHJcbiAgfSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["i0","ComprarProductoComponent","constructor","aRoute","productoService","localService","router","_snackBar","compraService","detalleCompraService","ngOnInit","Id","Number","snapshot","paramMap","get","getProducto","subscribe","producto","localId","getLocal","local","localNombre","nombreLo","id","precioUnitario","precioVendido","agregarAlCarrito","userId","localStorage","getItem","console","error","detalleCompra","productoId","cantidad","cantidadSeleccionada","compradorId","subtotal","addDetalleCompra","response","log","mensajeExito","open","duration","horizontalPosition","comprarProducto","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\54351\\Desktop\\Practica1\\Front\\src\\app\\components\\comprar-producto\\comprar-producto.component.html","C:\\Users\\54351\\Desktop\\Practica1\\Front\\src\\app\\components\\comprar-producto\\comprar-producto.component.ts"],"sourcesContent":["<body>\n  <div class=\"dash\">\n    <app-navbar></app-navbar>\n\n    <div class=\"main-and-sidebar\">\n      <!-- BODY -->\n      <main class=\"main\">\n        <app-ver-producto [id]=\"Id\"></app-ver-producto>\n      </main>\n\n      <!-- SIDEBAR -->\n      <div class=\"sidebar\">\n        <!-- Lista desplegable -->\n        <div class=\"dropdown\">\n          <button class=\"dropbtn\">Cantidad</button>\n          <div class=\"dropdown-content\">\n            <ul class=\"number-list\">\n              <li><a href=\"#\">1</a></li>\n              <li><a href=\"#\" >2</a></li>\n              <li><a href=\"#\" >3</a></li>\n              <li><a href=\"#\" >4</a></li>\n              <li><a href=\"#\" >5</a></li>\n            </ul>\n          </div>\n        </div>\n      \n        <!-- Botones adicionales -->\n        <div class=\"button-container\">\n          <button mat-raised-button color=\"accent\" >Comprar</button>\n          <button mat-stroked-button color=\"accent\" (click)=\"agregarAlCarrito()\">Agregar al carrito</button>\n        </div>\n        <div *ngIf=\"localNombre\">\n          Vendido por la tienda: {{ localNombre }}\n        </div>\n      </div>\n    </div>\n  </div>\n</body>","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ProductoService } from 'src/app/services/producto.service';\nimport { LocalService } from 'src/app/services/local.service';\nimport { DetalleCompraService } from 'src/app/services/detalle-compra.service'; // Importa el servicio y la interfaz de DetalleCompra\nimport { CompraService } from 'src/app/services/compra.service';\nimport { DetalleCompra } from 'src/app/interfaces/detalle-compra';\nimport { MatSnackBar } from '@angular/material/snack-bar';\n\n@Component({\n  selector: 'app-comprar-producto',\n  templateUrl: './comprar-producto.component.html',\n  styleUrls: ['./comprar-producto.component.css']\n})\nexport class ComprarProductoComponent implements OnInit {\n  Id!: number;\n  localNombre: string = '';\n  cantidadSeleccionada: number = 1;\n  precioUnitario: number = 0;\n  subtotal: number = 0;\n  localId: number = -1; // Inicializar localId con un valor predeterminado\n\n  constructor(\n    private aRoute: ActivatedRoute,\n    private productoService: ProductoService,\n    private localService: LocalService,\n    private router: Router,\n    private _snackBar: MatSnackBar,\n\n    private compraService: CompraService,\n    private detalleCompraService: DetalleCompraService // Inyecta el servicio de DetalleCompraService\n  ) {}\n\n  ngOnInit() {\n    this.Id = Number(this.aRoute.snapshot.paramMap.get('id'));\n    this.productoService.getProducto(this.Id).subscribe(producto => {\n      if (producto.localId) {\n        this.localService.getLocal(producto.localId).subscribe(local => {\n          this.localNombre = local.nombreLo;\n          this.localId = local.id ?? -1;\n        });\n      }\n      this.precioUnitario = producto.precioVendido;\n    });\n  }\n\n  agregarAlCarrito() {\n    const userId = localStorage.getItem('userId'); // Obtén el ID del usuario desde localStorage\n    if (!userId) {\n      console.error('El usuario no ha iniciado sesión.');\n      // Aquí podrías mostrar un mensaje al usuario para iniciar sesión o redirigirlo a la página de inicio de sesión\n      return;\n    }\n  \n    const detalleCompra: DetalleCompra = {\n      productoId: this.Id,\n      cantidad: this.cantidadSeleccionada,\n      precioUnitario: this.precioUnitario,\n      localId: this.localId,\n      compradorId: userId, // Establece el compradorId como el ID del usuario\n      subtotal: this.precioUnitario * this.cantidadSeleccionada\n    };\n  \n    // Llama al servicio para agregar el detalle de compra al carrito\n    this.detalleCompraService.addDetalleCompra(detalleCompra).subscribe(\n      response => {\n        console.log('Producto agregado al carrito:', response);\n        // Muestra el mensaje de éxito\n        this.mensajeExito();\n        // Aquí podrías redirigir al usuario a la página del carrito o mostrar un mensaje de éxito\n      },\n      error => {\n        console.error('Error al agregar producto al carrito:', error);\n        // Aquí podrías mostrar un mensaje de error al usuario\n      }\n    );\n  }\n  mensajeExito() {\n    this._snackBar.open(`El producto fue añadido al carrito con éxito`,'', {\n      duration: 4000,\n      horizontalPosition: 'right',\n    });\n  }\n  comprarProducto() {\n    // Aquí podrías implementar la lógica para comprar el producto directamente en lugar de agregarlo al carrito\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}